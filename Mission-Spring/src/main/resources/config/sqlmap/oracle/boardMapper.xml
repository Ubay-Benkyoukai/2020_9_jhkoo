<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board.dao.BoardDAO">

  	<select id="selectAll" resultType="boardVO">
  		SELECT no, title, writer, date_format(reg_date, '%Y-%m-%d') as regDate
  			FROM a_board
  			ORDER BY no DESC
  	</select>
  	
  	<!-- '_'는 자동으로 객체 반환해주지 못함. 그래서 이 작업 필요. -->
  	<resultMap type="boardVO" id="boardMap">
  		<result column="view_cnt" property="viewCnt" />
  		<result column="reg_date" property="regDate" />
  	</resultMap>
  	
  	<!-- 게시글 상세보기 -->
  	<select id="selectByNo" resultMap="boardMap" parameterType="int">
  		SELECT no, title, writer, content, view_cnt, date_format(reg_date, '%Y-%m-%d') as regDate
  		FROM a_board
  		WHERE no = #{no}
  	</select>
  	
  	<insert id="insert" parameterType="boardVO">
  		INSERT INTO a_board(title, writer, content)
  		VALUES(#{title}, #{writer}, #{content})
  	</insert>
  	
  	<!-- 댓글 카운트 증가 -->
  	<update id="increamentReplyCnt" parameterType="int">
  		UPDATE a_board
  			SET reply_cnt = reply_cnt + 1
  		 WHERE no = #{no}
  	</update>
  	
  	<!-- 댓글 카운트 감소 -->
  	<update id="reduceReplyCnt" parameterType="int">
  		UPDATE a_board
  			SET reply_cnt = reply_cnt - 1
  		 WHERE no = #{no}
  	</update>
  	
</mapper>



